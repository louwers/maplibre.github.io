<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="map[]"><meta name=keywords content><meta name=description content="MapLibre GL JS v3 - Improvements to WebGL2, Terrain3D, Color spaces, Performance and more!"><meta name=theme-color content="#fff"><meta property="og:image" content="https://maplibre.org/img/share-image.png"><meta property="og:image:width" content="1024"><meta property="og:image:height" content="512"><meta property="og:image:alt" content="MapLibre"><meta property="og:title" content="MapLibre GL JS v3"><meta property="og:description" content="MapLibre GL JS v3 - Improvements to WebGL2, Terrain3D, Color spaces, Performance and more!"><meta property="og:url" content="https://maplibre.org/news/2023-05-23-maplibre-gl-js-v3/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@maplibre"><meta name=twitter:creator content="@maplibre"><meta name=twitter:title content="MapLibre GL JS v3"><meta name=twitter:description content="MapLibre GL JS v3 - Improvements to WebGL2, Terrain3D, Color spaces, Performance and more!"><meta name=twitter:image:src content="https://maplibre.org/img/share-image.png"><meta name=twitter:image:alt content="MapLibre"><link rel=me href=https://mastodon.social/@maplibre><link rel=stylesheet href=/style.min.fb20e75ad9ca28b026ee9c0b987a6064ae296549096f147ff4f131382365265c.css><link rel=stylesheet href=/mapbox-gl.731181d400d65a8b09d842f55b70bc4dc11010b15b8549e2c65a69d233fbdd2e.css><script type=text/javascript src=/main.20f321987eaf1a05f6c91437adad3e7d86fc01b66ed465e1199a462572b4f3c7.js></script><title>MapLibre GL JS v3 |
MapLibre</title></head><body><nav class="navbar navbar-expand-lg navbar-dark fixed-top
bg-navbar"><div class=container><a class=navbar-brand href=/ aria-label=MapLibre><svg aria-hidden="true" width="141" height="30" viewBox="0 0 141 30" xmlns="http://www.w3.org/2000/svg"><use href="/img/maplibre-logo.svg#maplibre-logo"/></svg></a><div class=d-flex><button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarNavAltMarkup aria-controls=navbarNavAltMarkup aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button>
<a class="nav-link py-1 py-lg-0 d-flex align-items-center d-lg-none text-white" href=https://github.com/MapLibre aria-label="MapLibre organization on Github"><svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30"><use href="/img/github.svg#github"/></svg></a></div><div class="collapse navbar-collapse justify-content-end" id=navbarNavAltMarkup><div class=navbar-nav><li><a class=nav-link href=/about/>About</a></li><li><a class=nav-link href=/jobs/>Jobs</a></li><li><a class=nav-link href=/roadmap/>Roadmap</a></li><li><a class=nav-link href=/sponsors/>Sponsors</a></li><li><a class=nav-link href=/news/>News</a></li><li><a class=nav-link href=/projects/>Projects</a></li><li><a class=nav-link href=/community/>Community</a></li></div></div><a class="nav-link py-1 py-lg-0 d-none align-items-center d-lg-flex text-white" href=https://github.com/MapLibre aria-label="MapLibre organization on Github"><svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30"><use href="/img/github.svg#github"/></svg></a></div></nav><div class="container-fluid px-0 mb-6"><div class="row mx-0 bg-title text-center align-items-center"><h1 class="text-white pt-6">MapLibre GL JS v3</h1></div></div><div class=container><div class=row><div class=post-meta-date><time datetime=" 2023-05-23">May 23, 2023</time>
<span>Â·</span>
<span>4 minutes read</span></div><div>Categories:
<span class="badge bg-light"><a href=https://maplibre.org/categories/announcements/>announcements</a></span></div><div>Authors:
<span><span class="badge bg-light"><a href=https://maplibre.org/authors/birk/>Birk Skyum</a></span></span></div></div><div class="row mt-4"><div><meta name=twitter:site content="@maplibre"><meta name=twitter:title content="MapLibre GL JS v3"><meta property="twitter:domain" content="maplibre.org"><meta name=twitter:card content="summary_large_image"><meta property="twitter:url" content="https://maplibre.org/news/2023-05-23-maplibre-gl-js-v3/"><meta name=twitter:description content="MapLibre GL JS v3 - Improvements to Terrain3D, WebGL2, Color spaces, Performance and more!"><meta name=twitter:image content="https://maplibre.org/news/2023-05-23-maplibre-gl-js-v3/header.png"><p>This release is a big step for MapLibre GL JS! With more than 500 commits, and almost a year in the making, version 3.0.0 is surely our best release yet. Lots of features, performance improvement, bug fixes and a few potentially breaking changes that were necessary, to keep the project healthy, are to be found here.</p><p><strong>A note on migration:</strong>
Most users will be able to update to v3 without code changes, but it&rsquo;s recommended to read the section on potentially breaking changes in the changelog carefully to assess if you&rsquo;re code needs migration.</p><p>Thanks for all the code contributions!</p><p><a href=https://github.com/rotu target=_blank rel=noopener>@rotu</a>, <a href=https://github.com/pramilk target=_blank rel=noopener>@pramilk</a>, <a href=https://github.com/zhangyiatmicrosoft target=_blank rel=noopener>@zhangyiatmicrosoft</a>, <a href=https://github.com/prozessor13 target=_blank rel=noopener>@prozessor13</a>, <a href=https://github.com/Pessimistress target=_blank rel=noopener>@Pessimistress</a>, <a href=https://github.com/ChrisLoer target=_blank rel=noopener>@ChrisLoer</a>, <a href=https://github.com/xabbu42 target=_blank rel=noopener>@xabbu42</a>, <a href=https://github.com/VehpuS target=_blank rel=noopener>@VehpuS</a>, <a href=https://github.com/zstadler target=_blank rel=noopener>@zstadler</a>, <a href=https://github.com/ZeLonewolf target=_blank rel=noopener>@ZeLonewolf</a>, <a href=https://github.com/kajkal target=_blank rel=noopener>@kajkal</a>, <a href=https://github.com/kevinschaul target=_blank rel=noopener>@kevinschaul</a>, <a href=https://github.com/ambientlight target=_blank rel=noopener>@ambientlight</a>, <a href=https://github.com/smellyshovel target=_blank rel=noopener>@smellyshovel</a>, <a href=https://github.com/kircher1 target=_blank rel=noopener>@kircher1</a>, <a href=https://github.com/tordans target=_blank rel=noopener>@tordans</a>, <a href=https://github.com/IvanSanchez target=_blank rel=noopener>@IvanSanchez</a>, <a href=https://github.com/acalcutt target=_blank rel=noopener>@acalcutt</a>, <a href=https://github.com/jleedev target=_blank rel=noopener>@jleedev</a>, <a href=https://github.com/llambanna target=_blank rel=noopener>@llambanna</a>, <a href=https://github.com/cns-solutions-admin target=_blank rel=noopener>@cns-solutions-admin</a>, <a href=https://github.com/vanilla-lake target=_blank rel=noopener>@vanilla-lake</a>, <a href=https://github.com/lukashass target=_blank rel=noopener>@lukashass</a></p><p>Facilitated by:</p><p><a href=https://github.com/HarelM target=_blank rel=noopener>@HarelM</a>, <a href=https://github.com/BirkSkyum target=_blank rel=noopener>@BirkSkyum</a>, <a href=https://github.com/wipfli target=_blank rel=noopener>@wipfli</a></p><h1 id=notable-changes-for-this-release>Notable changes for this release <a class=heading-link href=#notable-changes-for-this-release></a></h1><h2 id=performance>Performance <a class=heading-link href=#performance></a></h2><p>A lot of work has been put into making this version of MapLibre GL JS faster. Here are some of the highlights:</p><ul><li>Lazy load default style properties on demand to improve loading performance and reduce memory usage. (<a href=https://github.com/maplibre/maplibre-gl-js/pull/2476 target=_blank rel=noopener>#2476</a>)</li><li>Improve performance by sending style layers to the worker thread before processing it on the main thread to allow parallel processing (<a href=https://github.com/maplibre/maplibre-gl-js/pull/2131 target=_blank rel=noopener>#2131</a>)</li><li>Improve performance when forcing full symbol placement by short-circuiting pause checks (<a href=https://github.com/maplibre/maplibre-gl-js/pull/2241 target=_blank rel=noopener>#2241</a>)</li><li>Improve initial loading performance by lazy serializing layers only when needed. (<a href=https://github.com/maplibre/maplibre-gl-js/pull/2306 target=_blank rel=noopener>#2306</a>)</li><li>Add validateStyle MapOption to allow disabling style validation for faster performance in a production environment. (<a href=https://github.com/maplibre/maplibre-gl-js/pull/2390 target=_blank rel=noopener>#2390</a>)</li><li>Throttle the image request queue while the map is moving to improve performance (<a href=https://github.com/maplibre/maplibre-gl-js/issues/2097 target=_blank rel=noopener>#2097</a>)</li><li>Improve control initial loading performance by forcing fadeDuration to 0 till the first idle event (<a href=https://github.com/maplibre/maplibre-gl-js/pull/2447 target=_blank rel=noopener>#2447</a>)</li><li>Improve control performance by restricting worker count to a max of 1 except for Safari browser. (<a href=https://github.com/maplibre/maplibre-gl-js/pull/2354 target=_blank rel=noopener>#2354</a>)</li><li>Bump KDBush and supercluster for better memory efficiency (<a href=https://github.com/maplibre/maplibre-gl-js/pull/2522 target=_blank rel=noopener>#2522</a>)</li><li>Speed up the cross tile symbol index in certain circumstances (<a href=https://github.com/maplibre/maplibre-gl-js/pull/1755 target=_blank rel=noopener>#1755</a>)</li><li>Improve rendering speed in scenes with many colliding symbolic icons and labels (<a href=https://github.com/maplibre/maplibre-gl-js/pull/1757 target=_blank rel=noopener>#1757</a>)</li><li>Make request for ImageSource cancelable (<a href=https://github.com/maplibre/maplibre-gl-js/pull/1802 target=_blank rel=noopener>#1802</a>)</li><li>Prevent unnecessary reload of raster sources when RTL Text Plugin loads (<a href=https://github.com/maplibre/maplibre-gl-js/issues/2380 target=_blank rel=noopener>#2380</a>)</li><li>Fix event.isSourceLoaded to reflect the state of source loading for sourcedata event (<a href=https://github.com/maplibre/maplibre-gl-js/pull/2543 target=_blank rel=noopener>#2543</a>)</li></ul><h2 id=transformcameraupdate>transformCameraUpdate <a class=heading-link href=#transformcameraupdate></a></h2><a href="https://stackblitz.com/edit/vitejs-vite-8nntze?file=src%2FMinimap.tsx"><img src=minimap.png style=max-width:600px;width:100%></a><p>This new feature makes it possible to get direct access to the camera transform, and manipulate it, continuously whenever the map is attempting to change it&rsquo;s viewport. It&rsquo;s a small hook, but it&rsquo;s very powerful. It&rsquo;s especially handy for reactive frameworks, where the camera state might be put in a store which can trigger side effects like listing the points of interest currently visible on the map. Another example of when it&rsquo;s relevant is when synching multiple maps, as exemplified with a demo of a minimap and a main map that drives each other here:</p><p>Sync two maps with the camera transform - <a href="https://stackblitz.com/edit/vitejs-vite-8nntze?file=src%2FMinimap.tsx" target=_blank rel=noopener>Minimap demo</a></p><br><h2 id=terrain-3d>Terrain 3D <a class=heading-link href=#terrain-3d></a></h2><p>The terrain is becoming more stable, with a range of improvements landing in v3.</p><ul><li>Add queryTerrainElevation allows getting terrain elevation in meters at a specific point (<a href=https://github.com/maplibre/maplibre-gl-js/pull/2264 target=_blank rel=noopener>#2264</a>)</li><li>Adding a <code>warnonce</code> when terrain and hillshade source are the same (<a href=https://github.com/maplibre/maplibre-gl-js/pull/2298 target=_blank rel=noopener>#2298</a>)</li><li>Move terrain object from style.terrain to map.terrain (<a href=https://github.com/maplibre/maplibre-gl-js/pull/1628 target=_blank rel=noopener>#1628</a>)</li><li>Fix the gap between terrain elevated tiles (<a href=https://github.com/maplibre/maplibre-gl-js/issues/1602 target=_blank rel=noopener>#1602</a>)</li><li>Fix wrap coords in <code>getTerrain</code> when <code>fitBounds</code> across the AM (<a href=https://github.com/maplibre/maplibre-gl-js/pull/2155 target=_blank rel=noopener>#2155</a>)</li><li>Fix <code>getElevation()</code> causing an uncaught error (<a href=https://github.com/maplibre/maplibre-gl-js/issues/1650 target=_blank rel=noopener>#1650</a>).</li><li>Add map.getCameraTargetElevation() (<a href=https://github.com/maplibre/maplibre-gl-js/pull/1558 target=_blank rel=noopener>#1558</a>)</li><li>Add <code>freezeElevation</code> to <code>AnimationOptions</code> to allow smooth camera movement in 3D (<a href=https://github.com/maplibre/maplibre-gl-js/pull/1514 target=_blank rel=noopener>#1514</a>)</li><li>Improve rendering of areas below sea level, and remove elevationOffset workaround (<a href=https://github.com/maplibre/maplibre-gl-js/pull/1578 target=_blank rel=noopener>#1578</a>)</li><li>Fix overlapping of 3D building parts when 3D Terrain is activated (<a href=https://github.com/maplibre/maplibre-gl-js/issues/2513 target=_blank rel=noopener>#2513</a>)</li><li>Show 3D buildings located below sea level when 3D Terrain is activated (<a href=https://github.com/maplibre/maplibre-gl-js/issues/2544 target=_blank rel=noopener>#2544</a>)</li></ul><br><h2 id=webgl2>WebGL2 <a class=heading-link href=#webgl2></a></h2><p>WebGL2 has finally reached a level of browser support that allows us, and large projects like <a href=https://forum.unity.com/threads/removing-support-for-gles2-and-webgl1-in-2023-1a.1360090/ target=_blank rel=noopener>Unity</a> to embrace it fully. While WebGL2 is mostly backward compatible, it gives us lots of new features, and opportunities to improve performance through parallelization. It also removes the friction that exists when using MapLibre GL JS with libraries in the ecosystem that has moved to WebGL2 already - two examples of which can be seen in the demos below:</p><p><strong>Interleaved rendering of DeckGL attribute transitions</strong></p><a href=https://codepen.io/birkskyum-1471370946/pen/VwEBPYW><img src=attributetransitions.png style=max-width:600px;width:100%></a><p>3.0.0 - <a href=https://codepen.io/birkskyum-1471370946/pen/VwEBPYW target=_blank rel=noopener>Animating</a> - Uses WebGL2</p><p>2.4.0 - <a href=https://codepen.io/birkskyum-1471370946/pen/qBJyRdR target=_blank rel=noopener>Not animating</a></p><br><p><strong>Interleaved rendering of DeckGL GPU accelerated GridLayer</strong></p><a href="https://stackblitz.com/edit/vitejs-vite-asczxg?file=package.json"><img src=gpugridlayer.png style=max-width:600px;width:100%></a><p>3.0.0 <a href="https://stackblitz.com/edit/vitejs-vite-asczxg?file=package.json" target=_blank rel=noopener>GPU Accelerated</a> - Uses WebGL2</p><p>2.4.0 <a href="https://stackblitz.com/edit/vitejs-vite-9scpcz?file=package.json" target=_blank rel=noopener>Breaks</a> - Browser console prints &ldquo;Browser not supported&rdquo;</p><br><h2 id=color-spaces>Color spaces <a class=heading-link href=#color-spaces></a></h2><a href=https://kajkal.github.io/maplibre-gl-style-spec-color-demo/swipe.html><img src=colorspaces.png style=max-width:600px;width:100%></a><p>We now align better with the CSS Spec for color spaces, by using the D50 illuminant instead of the D65. This brings us more continuous color spaces with the <code>interpolate-hcl</code>. To see what that means in practice, the demo <a href=https://kajkal.github.io/maplibre-gl-style-spec-color-demo/swipe.html target=_blank rel=noopener>here</a> is a visualization of the color spaces. You can i.e. select 3.0.0-pre.4 and 3.0.0-pre.5, which is when the addition was made, and move the cursor up and down to compare them.</p><h1 id=changelog>Changelog <a class=heading-link href=#changelog></a></h1><p>See a full changelog <a href=https://github.com/maplibre/maplibre-gl-js/blob/main/CHANGELOG.md#300 target=_blank rel=noopener>here</a>, including the list of potentially breaking changes.</p></div></div></div><footer class=mt-auto><div class="container pb-4 pt-6"><a href=/ aria-label=MapLibre><svg aria-hidden="true" width="141" height="30" viewBox="0 0 141 30" xmlns="http://www.w3.org/2000/svg"><use href="/img/maplibre-logo-dark.svg#maplibre"/></svg></a></div><div class="container border-top border-gray"><div class="row py-3"><div class=col-sm-6><div class=nav><li><a class="nav-link text-black-50" href=/>MapLibre</a></li><li><a class="nav-link text-black-50" href=/jobs/>Jobs</a></li><li><a class="nav-link text-black-50" href=/sponsors/>Sponsors</a></li><li><a class="nav-link text-black-50" href=/projects/>Projects</a></li></div></div><div class=col-sm-1><div class="d-flex justify-content-center text-black-50 nav-link">CC0</div></div><div class="col-sm-2 flex"><div class="text-black-50 d-flex justify-content-center nav-link"><a class=text-black-50 href=https://github.com/maplibre/maplibre.github.io>GitHub</a>
@
<a class=text-black-50 href=#ZgotmplZ/commit/b345035102ad70a3e0f9ba730203afb65bd39918>b345035</a></div></div><div class=col-sm-3><div class="nav justify-content-end"><a class="nav-link text-black-50" href=https://mastodon.social/@maplibre aria-label="MapLibre on Mastodon"><svg id="mas" viewBox="0 0 16 16" width="16" height="16" xmlns="http://www.w3.org/2000/svg"><path fill="#979da6" d="M15.659 9.592C15.424 10.72 13.553 11.956 11.404 12.195 10.283 12.32 9.18 12.434 8.003 12.384 6.079 12.302 4.56 11.956 4.56 11.956 4.56 12.13 4.572 12.297 4.595 12.452c.25 1.772 1.883 1.878 3.43 1.927C9.586 14.429 10.976 14.02 10.976 14.02L11.04 15.337S9.948 15.884 8.003 15.984C6.93 16.039 5.598 15.959 4.047 15.576.683 14.746.104 11.4.015 8.006-.012 6.998.005 6.048.005 5.253.005 1.782 2.443.765 2.443.765 3.672.238 5.782.017 7.975.0H8.029c2.192.017 4.303.238 5.532.765.0.0 2.438 1.017 2.438 4.488.0.0.0310000000000006 2.561-.34 4.339zm-2.535-4.07V9.725H11.339V5.646c0-.86-.388-1.296-1.164-1.296C9.317 4.35 8.887 4.867 8.887 5.891V8.124H7.113V5.891C7.113 4.867 6.683 4.35 5.825 4.35c-.776.0-1.164.436-1.164 1.296V9.725H2.876V5.522c0-.859.235-1.541.706-2.046.485-.505 1.121-.764 1.911-.764C6.406 2.712 7.098 3.039 7.555 3.695L8 4.39l.445-.695C8.902 3.039 9.594 2.712 10.507 2.712 11.297 2.712 11.933 2.971 12.418 3.476 12.889 3.981 13.124 4.663 13.124 5.522z" style="stroke:none;stroke-miterlimit:10;fill-rule:evenodd"/></svg></a><a class="nav-link text-black-50" href=https://twitter.com/maplibre aria-label="MapLibre on Twitter"><svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><use href="/img/icon/twt.svg#twt"/></svg></a></div></div></div></div></footer></body></html>